// WARNING: Please don't edit this file. It was generated by wv2winrt v1.0.0.0
#include "pch.h"

#include "wv2winrt/asyncdispatch.h"
#include "wv2winrt/converter.h"
#include "wv2winrt/eventargsdispatch.h"
#include "wv2winrt/implicitstructs.g.h"
#include "wv2winrt/main.h"
#include "wv2winrt/returnaggregator.h"
#include "wv2winrt/uniquevariant.h"
#include "wv2winrt/Windows.g.h"
#include "wv2winrt/Windows.Globalization.g.h"
#include "wv2winrt/Windows.System.g.h"
#include "wv2winrt/Windows.Foundation.g.h"
#include "wv2winrt/Windows.Storage.g.h"
#include "wv2winrt/Windows.Data.g.h"

namespace wv2winrt_impl
{
Namespace_Windows::Namespace_Windows(const winrt::Microsoft::Web::WebView2::Core::ICoreWebView2DispatchAdapter& dispatchAdapter)
    : m_dispatchAdapter(dispatchAdapter)
{
}

const static wchar_t* const s_Namespace_Windows_dispatchProperties[] =
{
    L"Data",
    L"Foundation",
    L"Globalization",
    L"Storage",
    L"System"
};
DispatchProperties Namespace_Windows::s_dispatchProperties = s_Namespace_Windows_dispatchProperties;

const DISPID Namespace_Windows::s_dispatchIds[5] =
{
    325,
    35,
    2,
    52,
    4
};

HRESULT Namespace_Windows::GetPropertyNames(wchar_t*** namesOut, size_t* namesLengthOut)
{
    *namesLengthOut = ARRAYSIZE(s_Namespace_Windows_dispatchProperties);
    *namesOut = const_cast<wchar_t **>(s_dispatchProperties);
    return S_OK;
}

HRESULT Namespace_Windows::GetIDsOfNames(REFIID riid,
                                                  LPOLESTR* names,
                                                  unsigned int namesCount,
                                                  LCID localeId,
                                                  DISPID* dispId)
{
    HRESULT hr = DispatchBase::GetIDsOfNames(riid, names, namesCount, localeId, dispId);
    if (SUCCEEDED(hr))
    {
        hr = DISP_E_MEMBERNOTFOUND;
        size_t idx;
        if (LookupProperty(s_dispatchProperties, names[0], idx, 5))
        {
            *dispId = s_dispatchIds[idx];
            hr = S_OK;
        }
    }
    return hr;
}

HRESULT Namespace_Windows::Invoke(DISPID dispId,
                                           REFIID riid,
                                           LCID localeId,
                                           WORD flags,
                                           DISPPARAMS* dispParams,
                                           VARIANT* result,
                                           EXCEPINFO* excepInfo,
                                           UINT* argErr)
{
    HRESULT hr = DispatchBase::Invoke(dispId,
                                      riid,
                                      localeId,
                                      flags,
                                      dispParams,
                                      result,
                                      excepInfo,
                                      argErr);

    if (SUCCEEDED(hr))
    {
        hr = DISP_E_MEMBERNOTFOUND;
        if (flags == DISPATCH_PROPERTYGET)
        {
            if (dispParams->cArgs != 0 ||
                dispParams->rgvarg != nullptr)
            {
                hr = E_INVALIDARG;
            }
            else
            {
                winrt::com_ptr<IDispatch> dispatch;
#pragma warning( push )
#pragma warning( disable: 4065 )
                switch (dispId)
                {
                    case 2:
                    {
                        dispatch = m_dispatchAdapter.WrapNamedObject(L"Windows.Globalization", m_dispatchAdapter).as<IDispatch>();
                        hr = S_OK;
                        break;
                    }
                    case 4:
                    {
                        dispatch = m_dispatchAdapter.WrapNamedObject(L"Windows.System", m_dispatchAdapter).as<IDispatch>();
                        hr = S_OK;
                        break;
                    }
                    case 35:
                    {
                        dispatch = m_dispatchAdapter.WrapNamedObject(L"Windows.Foundation", m_dispatchAdapter).as<IDispatch>();
                        hr = S_OK;
                        break;
                    }
                    case 52:
                    {
                        dispatch = m_dispatchAdapter.WrapNamedObject(L"Windows.Storage", m_dispatchAdapter).as<IDispatch>();
                        hr = S_OK;
                        break;
                    }
                    case 325:
                    {
                        dispatch = m_dispatchAdapter.WrapNamedObject(L"Windows.Data", m_dispatchAdapter).as<IDispatch>();
                        hr = S_OK;
                        break;
                    }

                    default:
                        hr = DISP_E_MEMBERNOTFOUND;
                        break;
                }
#pragma warning( pop )

                if (SUCCEEDED(hr))
                {
                    // Copy dispatch into output result
                    VARIANT dispatchAsVariant;
                    dispatchAsVariant.vt = VT_DISPATCH;
                    dispatchAsVariant.pdispVal = dispatch.detach();
                    *result = dispatchAsVariant;
                }
            }
        }
    }
    return hr;
}

}


